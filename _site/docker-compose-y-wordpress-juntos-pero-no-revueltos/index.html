<!DOCTYPE html>
<html>

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Docker Compose y WordPress: juntos pero no revueltos</title>
    <meta name="description" content="Fricolab is a multidisciplinary project led by David A. Lareo. We believe that open technology is one of the main tools for promoting social change and help to build a fairer and more beautiful world.
">

    <!-- CSS  -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="/css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    <link href="/css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    <link rel="canonical" href="https://fricolab.github.io//docker-compose-y-wordpress-juntos-pero-no-revueltos/">
</head>


  <body>

    <header class="site-header">

  <nav class="white" role="navigation">
    <div class="nav-wrapper container">
      <a id="logo-container" href="/" class="brand-logo"><object id="front-page-logo" class="responsive-img" width="120px" type="image/png" data="/images/logo_fricolaB.png">Your browser does not support SVG.</object></a>
      <ul class="right hide-on-med-and-down">
        <li><a href="/blog">Blog</a></li>
      </ul>
      <ul id="nav-mobile" class="side-nav">
        <li><a href="/blog">Blog</a></li>
      </ul>
      <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
    </div>
  </nav>

</header>


        <div class="post container">

  <header class="post-header">
    <h1 class="post-title">Docker Compose y WordPress: juntos pero no revueltos</h1>
    <p class="post-meta">Sep 22, 2015 • david</p>
  </header>

  <article class="post-content">
    <p>Desde hace ya algunos meses estamos trabajando con <a href="https://www.docker.com/">Docker</a>, <strong>un software/plataforma para desarrolladores y administradores de sistema</strong> usado también por los <strong>peces gordos de la web</strong> como <a href="https://www.spotify.com/es/">Spotify</a> o <a href="https://taiga.io/">Taiga</a>, una alternativa a <a href="https://trello.com/">Trello</a> con software libre que también usamos desde hace un tiempo.</p>

<p>Quizá aquellas que aún no conocen Docker se pregunten qué es lo que esta nueva plataforma viene a solucionar o a mejorar. Destacamos <strong>sus principales ventajas</strong> en los siguientes puntos:</p>

<p>– <strong>Agilidad</strong>: El despliegue de una aplicación con Docker es mucho <strong>más rápido y sencillo</strong>.</p>

<p>– <strong>Portabilidad</strong>: Nuestras aplicaciones se podrán ejecutar en cualquier otra máquina en la que esté instalado Docker.</p>

<p>– <strong>Flexibilidad</strong>: Docker se adapta a nuestros requisitos, pues “viene con las pilas puestas, pero se pueden sacar”, esto es, <strong>incorpora soluciones nativas</strong> pero es susceptible de integrarse con otras.</p>

<p>– <strong>Escalabilidad</strong>: Una de las bazas más interesantes de Docker es la <strong>facilidad con la que escala, tanto horizontal como verticalmente</strong>. En relación a la escalabilidad de Docker es especialmente interesante <a href="https://docs.docker.com/swarm/">Docker Swarm</a>.</p>

<p>– <strong>muchas más</strong> que puedes descubrir tú misma…</p>

<p><strong>Docker</strong> tiene un <strong>repositorio propio de aplicaciones</strong> (<a href="https://hub.docker.com/">Registry Hub</a>) en el que podemos encontrar imágenes de nuestras aplicaciones preferidas, incluyendo <a href="https://hub.docker.com/_/wordpress/">WordPress</a>, por supuesto. Sin embargo, nuestra experiencia usando <strong>Docker</strong> y <strong>WordPress</strong> conjuntamente nos ha enseñado que la solución oficial no resuelve todos los problemas que el diseñador o desarrollador se encuentra. El principal es la posibilidad de <strong>instalar nuevos plugins y temas</strong>, así como modificar los existentes sin necesidad de modificar la imagen original, esto es, de manera que los cambios que realicemos en el código se incorporen al proyecto automáticamente, como haríamos con cualquier instalación de WordPress. Otra cuestión relevante que creemos que se puede mejorar es el proceso de creación de los contenedores, esto es, el despliegue de la aplicación o su instalación en un determinado host. Pero no nos vamos muy lejos, pues la solución viene de la mano de Docker, con <a href="https://docs.docker.com/compose/">Docker Compose</a>, una aplicación de reciente incorporación a la caja de herramientas de Docker, junto a Swarm (que ya hemos mencionado) y <a href="https://docs.docker.com/machine/">Docker Machine</a>.</p>

<p>Excede el alcance de este pequeño post explicar con detalles las características de Docker, así como las posibilidades que se abren y que constantemente dan lugar a nuevas aplicaciones. Explico pues cual es el <strong>proceso para tener una instalación de WordPress dockerizada</strong>.</p>

<p>En <strong>primer lugar</strong> deberemos instalar en nuestro host <a href="https://docs.docker.com/installation/">Docker</a> y <a href="https://docs.docker.com/compose/install/">Docker Compose</a>.</p>

<p>A continuación descargaremos la última versión de WordPress disponible con este comando:</p>

<p><code>$ curl https://wordpress.org/latest.tar.gz | tar -xvzf -</code></p>

<p>En el directorio en el que hemos descomprimido WordPress crearemos ahora un par de archivos:</p>

<p><strong>a) docker-compose.yml</strong></p>

<p>Este archivo nos permitirá definir como queremos que se integren los dos contenedores que necesitamos, WordPress y una base de datos MySql, y también nos permitirá definir un volumen de datos para poder modificar los archivos de nuestra aplicación: instalar plugins, modificar el <em>wp-config.php</em>, etc.</p>

<p>El contenido de este archivo será el siguiente:</p>

<pre><code>wordpress:
   image: wordpress
   volumes:
   - .:/var/www/html
   links:
   - db:mysql
   ports:
   - 8080:80
db:
   image: mariadb
   environment:
   MYSQL_ROOT_PASSWORD: password
</code></pre>

<p>Sin entrar en detalles acerca de la sintaxis de este archivo, solamente indicar que en él estamos indicando los dos contenedores (<em>wordpress</em> y <em>db</em>) que formarán nuestra aplicación con Docker, así como la imágenes de las que dependen (<em>wordpress</em> y <em>mariadb</em>), estableciendo un enlace entre ellos, redirigiendo el puerto <em>8080</em> de nuestro host al puerto <em>80</em> de la aplicación y montando el directorio actual del <em>host</em> en la ruta <em>/var/www/html</em> del contenedor, esto es, donde están los archivos de WordPress, de manera que estamos utilizando los archivos que previamente hemos descargado de la web oficial de WordPress.</p>

<p><strong>b) wp-config.php</strong></p>

<p>Este archivo lo podemos obtener copiando el existente wp-config-sample.php pero modificando algunos datos, de manera que el archivo definitivo sea algo parecido a:</p>

<p>define(‘DB_NAME’, ‘wordpress’);</p>

<p>define(‘DB_USER’, ‘root’);</p>

<p>define(‘DB_PASSWORD’, ‘password’);</p>

<p>define(‘DB_HOST’, “mysql”);</p>

<p>define(‘DB_CHARSET’, ‘utf8’);</p>

<p>define(‘DB_COLLATE’, ”);</p>

<p>define(‘AUTH_KEY’, ‘put your unique phrase here’);</p>

<p>define(‘SECURE_AUTH_KEY’, ‘put your unique phrase here’);</p>

<p>define(‘LOGGED_IN_KEY’, ‘put your unique phrase here’);</p>

<p>define(‘NONCE_KEY’, ‘put your unique phrase here’);</p>

<p>define(‘AUTH_SALT’, ‘put your unique phrase here’);</p>

<p>define(‘SECURE_AUTH_SALT’, ‘put your unique phrase here’);</p>

<p>define(‘LOGGED_IN_SALT’, ‘put your unique phrase here’);</p>

<p>define(‘NONCE_SALT’, ‘put your unique phrase here’);</p>

<p>$table_prefix = ‘wp_’;</p>

<p>define(‘WPLANG’, ”);</p>

<p>define(‘WP_DEBUG’, false);</p>

<p>if ( !defined(‘ABSPATH’) )</p>

<p>define(‘ABSPATH’, dirname(__FILE__) . ‘/’);</p>

<p>require_once(ABSPATH . ‘wp-settings.php’);</p>

<p>Una vez que hayamos incorporado estos dos archivos, y habiendo instalado ya Docker y Docker Compose en nuestra máquina solamente tendremos que ejecutar el siguiente comando para instalar WordPress</p>

<p><code>docker-compose up</code></p>

<p>y ya podremos acceder a nuestra instalación desde la url</p>

<p><code>http://localhost:8080</code></p>

<p>Un último detalle importante si queremos que nuestra instalación de WordPress sea operativa es cambiar los permisos en el directorio principal, permitiendo lectura y escritura al daemon de Docker</p>

<p><code>sudo chmod -R 777 wordpress</code></p>

  </article>

</div>


      <footer class="page-footer teal lighten-4">
    <div class="container">
      <div class="row">
        <div class="col l6 s12">
          <h5 class="grey-text text-darken-4">About Us</h5>
          <p class="grey-text text-darken-1">Fricolab is a multidisciplinary project led by David A. Lareo. We believe that open technology is one of the main tools for promoting social change and help to build a fairer and more beautiful world. However we are aware that for most of you clicking on a button is just enough...</p>


        </div>
        <div class="col l3 s12">
          <h5 class="grey-text text-darken-4">Resources</h5>
          <ul>
            <li><a class="grey-text text-darken-1" href="/blog">Blog</a></li>
            <li><a class="grey-text text-darken-1" href="#!">Link 2</a></li>
            <li><a class="grey-text text-darken-1" href="#!">Link 3</a></li>
            <li><a class="grey-text text-darken-1" href="#!">Link 4</a></li>
          </ul>
        </div>
        <div class="col l3 s12">
          <h5 class="grey-text text-darken-4">Connect</h5>
          <ul>
            <li><a href="https://twitter.com/fricolab"><img src="/images/twitter.svg"></a></li>
            <li><a href="https://facebook.com/fricolab"><img src="/images/facebook-box.svg"></a></li>
            <li><a href="https://github.com/fricolab"><img src="/images/github-circle.svg"</a></li>
            <li><a class="grey-text text-darken-1" href="mailto:info@fricolab.com"><i class="material-icons">email</i></a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
      Made with <a class="white-text" href="http://materializecss.com">Materialize</a> and <a class="white-text" href="https://jekyllrb.com/">Jekyll</a>
      </div>
    </div>
  </footer>

      
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="/js/materialize.js"></script>
<script type="text/javascript" src="/js/init.js"></script>
<script type="text/javascript" src="/js/mail.js"></script>

  </body>

</html>
